TODO - really need a better way to deal with reflexive verbs
    separate part of speech

TODO - import word lists
    CSV:  word, pos, definition

TODO - notes for individual words.  there is already a notes column in the word table.  be aware that
    each word/pos_id pair will have its own notes, as these are a key in the word table.

FIXME - bug:
    go to a wordlist
    select a word - note the return-to-list link
    look up a word, doesn't matter if it's real
    there is no return-to-list link in the resultant lookup page

TODO - Nouns should be three separate parts of speech, one for each gender
    would have to update wordlists and quiz data.

TODO - add-word field in the tag editor page.  redirect to word edit page if the word doesn't exist.
    revise tag editor to show tooltip on mouse-over, giving POS and definition
    (schnelles HinzufÃ¼gen)

TODO - autosave word list notes.
    https://www.google.com/search?q=html+textarea+auto+save&newwindow=1&sca_esv=d160e5e212cd680a&ei=6TYeafOSLJvE0PEPiJingAU&ved=0ahUKEwizq5_LlP-QAxUbIjQIHQjMCVAQ4dUDCBE&uact=5&oq=html+textarea+auto+save&gs_lp=Egxnd3Mtd2l6LXNlcnAiF2h0bWwgdGV4dGFyZWEgYXV0byBzYXZlMgUQIRigATIFECEYoAEyBRAhGKABMgUQIRigATIFECEYoAEyBRAhGJ8FMgUQIRifBUiyZlCcHFj2YXABeAGQAQCYAaACoAH7E6oBBzEyLjEwLjG4AQPIAQD4AQGYAhigAvwUwgIKEAAYsAMY1gQYR8ICERAuGIAEGLEDGNEDGIMBGMcBwgIOEAAYgAQYsQMYgwEYigXCAgoQABiABBhDGIoFwgIIEAAYgAQYsQPCAg4QLhiABBixAxjRAxjHAcICCxAAGIAEGLEDGIMBwgIQEAAYgAQYsQMYQxiDARiKBcICERAAGIAEGLEDGIMBGIoFGI0GwgINEAAYgAQYsQMYQxiKBcICBRAAGIAEwgIGEAAYFhgewgIIEAAYFhgKGB7CAgUQABjvBcICCBAAGIAEGKIEwgIIEAAYogQYiQXCAgUQIRirApgDAIgGAZAGCJIHBzEyLjExLjGgB76CAbIHBzExLjExLjG4B_UUwgcIMC4xLjIyLjHIB2E&sclient=gws-wiz-serp

TODO - look for opportunities to use dictionary and set comprehensions.

TODO - create word lists from api calls since wordlists from sql don't give us enough.  examples:
    words in 5 or more lists
    most easily done as scripts run by cron

FIXME - place names should be properly capitalized.  sometimes they have an article.

TODO - parse definitions, and for each word in the definition that is in the dictionary, make a hyperlink to its
    lookup page.  this may cause hyperlinks to appear in english definitions, but too bad.  to do this, tokenize
    the definition including spaces, look up each token in the dictionary.

TODO - show me the words in a word list that were new.  i.e. words added after the word list was created.
    show in italics, bold, etc.

TODO - for parts of speech and their attributes add a display name column distinct from the key.  quiz table
    already does this.

TODO - dump out a smart wordlist as an ordinary word list.  this would effectively be a snapshot of the smart list.

FIXME - make sure http DELETE is not used for batch delete.

FIXME - when PUT or POST methods create something, send back a 201 not a 200.

TODO - TestCase.addCleanup exists, use it!

FIXME - in the lookup results page, add a word-entry text field.  it may be that an exact match of our input
    string is wanted but not present.

FIXME - remove attrvalue_id column from mashup_v

TODO - for definitions quiz app, can we just rewrite the whole thing as a class?

TODO - in quiz app, tag words that were missed/hinted, and also remove these tags

TODO - in quiz app, add options to k, l, and tags subcommands

FIXME - in quiz app, if you go to the main menu in the middle of a quiz where all word ids are prefetched,
    state is lost and you lose your place.  should keep state until list is changed or app is reset.  this state
    should be saved to disk on program exit.

TODO - api changes to support fetching words with the same tag from multiple wordlists
    augment GET /api/words to have tags in the URL

------

tag api changes:

relaxing the 'tags are per wordlist' restriction a bit.

- we want to query the same tag from multiple wordlists (e.g. hinted and missed tags)
- clear the same tag from multiple wordlists? ==> yes



------
to show all routes in the app:

(venv) MacBookPro:dlernen dougtomm$ FLASK_APP=run python -m flask routes --help
Usage: python -m flask routes [OPTIONS]

  Show all registered routes with endpoints and methods.

Options:
  -s, --sort [endpoint|methods|rule|match]
                                  Method to sort routes by. "match" is the
                                  order that Flask will match routes when
                                  dispatching a request.
  --all-methods                   Show HEAD and OPTIONS methods.
  --help                          Show this message and exit.

--------
to do local development install:

(venv) MacBookPro:deutsch_lernen dougtomm$ pwd
/Users/dougtomm/src/deutsch_lernen
(venv) MacBookPro:deutsch_lernen dougtomm$ python -m pip install -e .

---

as of sep 2025 this machine runs the following:

* sequoia 15.6
* python 3.13.7
* mysql 8.4.6

the name of the python executable is python3.  the command 'python'
will not be found in the environment.  do not finesse the PATH
or other env variables to make 'python' appear.  the way to do this
properly is with venv.

'python' and other essential utilities will appear in the virtual
environment.

Dougs-MacBook-Pro:deutsch_lernen dougtomm$ python3 -m venv venv/
Dougs-MacBook-Pro:deutsch_lernen dougtomm$ source venv/bin/activate
(venv) Dougs-MacBook-Pro:deutsch_lernen dougtomm$ which python
/Users/dougtomm/src/deutsch_lernen/venv/bin/python

then all you have to do is start the server:

(venv) MacBookPro:dlernen dougtomm$ pwd
/Users/dougtomm/src/deutsch_lernen/dlernen
(venv) MacBookPro:dlernen dougtomm$ ./start.sh
 * Serving Flask app 'dlernen'
 * Debug mode: on
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on http://127.0.0.1:5000
Press CTRL+C to quit
 * Restarting with stat
 * Debugger is active!
 * Debugger PIN: 772-306-967

-------

to run server health check (including db check):

(venv) MacBookPro:deutsch_lernen dougtomm$ curl 127.0.0.1:5000/healthcheck
OK(venv) MacBookPro:deutsch_lernen dougtomm$

------

to send a put request with curl:

curl -X PUT  -w "%{http_code}" -H "Content-Type: application/json" -d @baddog.json http://127.0.0.1:5000/api/wordlist/3750/contents
------

to run the tests:

(venv) MacBookPro:deutsch_lernen dougtomm$ pwd
/Users/dougtomm/src/deutsch_lernen
(venv) MacBookPro:deutsch_lernen dougtomm$ python -m unittest
............................................................................................
----------------------------------------------------------------------
Ran 92 tests in 6.027s

OK
(venv) MacBookPro:deutsch_lernen dougtomm$

we're using test discovery so that the command to run the suite is as simple as possible.
NOTE!  all the files with unit tests have to match the pattern test*.py, or else unittest won't find them.  stupid.

example of running an individual test:

(venv) MacBookPro:deutsch_lernen dougtomm$ python -m unittest tests.tests_api.APIWordlists.test_real_wordlist


------
backups

logrotate is configured to rotate the mysql dump file, which is in

~/Dropbox/personal/deutsch_lernen

config file is

/usr/local/etc/logrotate.d/deutsch.conf

backups are run through cron; see crontab -l

------

tests:

1. new word being added is nonempty when stripped - don't add '' or '   ' as words.
2. wordlist citation is never stored as empty string.  it should either be a nonempy string or null.

-----

misc

review how attribute values are stored.  make sure we aren't storing empty strings; unset attribute values
should be null in the database.

----
metadata:
- name
- id
- citation
- sqlcode
- source_is_url (derived value)
- type (empty, standard, smart.  derived value, not stored in database)

contents:
- known words
- unknown words
- notes

operations on list metadata:

- get (given list id)
    all metadata fields
- update (given list id)
    name (required)
    citation
    sqlcode
- create (adding a new empty list)
    name (required)
    citation
    sqlcode
- there is no delete operation on list metadata!  when we delete anything we delete the whole damn list.

operations on list

- get (including contents)
- delete (everything, both metadata and contents)

operations on list contents

- update (adding/deleting words, notes)

----------

word lookup:

by id:  easy

by word:  there will  be 0 or more associated word ids.  for every word id, fetch all attribute values
for the respective part of speech.

we can also get word lists by word id, so for each word we fetch we can get the word lists it's in, if desired.

editing/updating a word:

deleting a word:
we already have an endpoint to delete by id.  that's enough.  we won't ever use it in the UI.

--------------------
string comparisons:

mysql is case insensitive
python is case sensitive
